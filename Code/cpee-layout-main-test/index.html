<!--
  This file is part of cpee-layout.

  cpee-layout is free software: you can redistribute it and/or modify it under
  the terms of the GNU General Public License as published by the Free Software
  Foundation, either version 3 of the License, or (at your option) any later
  version.

  cpee-layout is distributed in the hope that it will be useful, but WITHOUT
  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
  FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
  details.

  You should have received a copy of the GNU General Public License along with
  cpee-layout (file COPYING in the main directory). If not, see
  <http://www.gnu.org/licenses/>.
-->

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>CPEE Layout Test</title>

  <!-- libs, do not modify. When local than load local libs. -->
  <script type="text/javascript" src="https://cpee.org/js_libs/jquery.min.js"></script>
  <script type="text/javascript" src="https://cpee.org/js_libs/util.js"></script>

  <!-- modelling ui -->
  <script type="text/javascript" src="wfadaptor.js"></script>
  <script type="text/javascript" src="extended_columns.js"></script>
  <link rel="stylesheet" href="wfadaptor.css" type="text/css" />

  <!-- integration -->
  <script>
    $(document).ready(() => {
      $.ajax({
        method: 'GET',
        url: 'model.xml',
        success: (data) => {
          new WfAdaptor('themes/extended/theme.js', function (graphrealization) {
            // graphrealization.draw_labels = (max, labels, shift, striped) => {
            //   console.log("1", shift);
            // };

            graphrealization.draw_labels = (max, labels, dimensions, striped) => {

              console.log("draw_labels ", max, labels, dimensions, striped);
              columns = draw_extended_columns(graphrealization, max, labels, dimensions, striped);
              console.log("columns ", columns);

              // Add the last stripe
              for (var i = 0; i < max.row; i++) {

                var ele = $('<div element-row="' + i + '" class="graphlast ' + (i % 2 == 0 ? 'odd' : 'even') + '" style="grid-column: ' + (columns + 2) + '; grid-row: ' + (i + 2) + '; height: ' + dimensions + 'px">&#032;</div>');
                console.log(i, columns, dimensions.stripe_height, ele);
                graphrealization.illustrator.svg.label_container.append(ele);
              }
            };


            graphrealization.set_svg_container($('#graphcanvas'));
            graphrealization.set_label_container($('#graphgrid'));
            graphrealization.set_description($(data), true);
          });
        },
      });

      // $.ajax({
      //   method: 'GET',
      //   url: 'Frames.xml',
      //   success: (data) => {
      //     WfAdaptor('themes/extended/theme.js', function (graphrealization) {
      //       graphrealization.draw_labels = (max, labels, shift, striped) => {
      //         // console.log(JSON.stringify(labels,  null, "  "));

      //       };
      //       graphrealization.set_svg_container($('#graphcanvas2'));
      //       graphrealization.set_label_container($('#graphgrid2'));
      //       graphrealization.set_description($(data), true);
      //     });
      //   },
      // });
    });
  </script>
</head>
<body>
  <div id='graphgrid'>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:x="http://www.w3.org/1999/xlink" id='graphcanvas'
      width='1' height='1'></svg>
  </div>
  <div id='graphgrid2'>
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:x="http://www.w3.org/1999/xlink" id='graphcanvas2'
      width='1' height='1'></svg>
  </div>
</body>
</html>